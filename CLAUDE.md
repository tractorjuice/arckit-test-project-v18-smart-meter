# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is an **ArcKit v1.0.3** architecture governance project for a **UK Smart Meter Data Consumer Mobile App**. It is not a software codebase—it is a structured collection of architecture artifacts, templates, and AI-driven commands for designing a mobile application that gives citizens access to their smart meter energy consumption data.

There is no build system, test framework, or application code. The project is operated entirely through AI assistant slash commands (`/arckit.*`) that generate governance documents into the `projects/` directory.

## Common Commands

### ArcKit Utility Scripts

```bash
# Generate a document ID for a new artifact
.arckit/scripts/bash/generate-document-id.sh --project 001 --type REQ

# List all projects and their status
.arckit/scripts/bash/list-projects.sh

# Check environment prerequisites
.arckit/scripts/bash/check-prerequisites.sh

# Create a new ArcKit project
.arckit/scripts/bash/create-project.sh --name "project-name"

# Migrate legacy filenames to Document ID convention
.arckit/scripts/bash/migrate-filenames.sh

# Convert Claude commands to Gemini CLI format
python3 .arckit/scripts/converter.py
```

All bash scripts support `--help` and `--json` flags for machine-readable output.

### Recommended Workflow for This Project

This is a UK Government project. Follow the UK Government Project Path from `DEPENDENCY-MATRIX.md`:

```
/arckit.plan → /arckit.principles → /arckit.stakeholders → /arckit.risk → /arckit.sobc →
/arckit.requirements → /arckit.data-model → /arckit.research → /arckit.wardley →
/arckit.gcloud-search → /arckit.gcloud-clarify → /arckit.evaluate → /arckit.hld-review →
/arckit.dld-review → /arckit.backlog → /arckit.servicenow → /arckit.devops →
/arckit.operationalize → /arckit.traceability → /arckit.tcop → /arckit.secure →
/arckit.principles-compliance → /arckit.analyze → /arckit.service-assessment → /arckit.story
```

## Architecture

### Document ID Convention

All artifacts use the pattern `ARC-{PROJECT_ID}-{TYPE}-v{MAJOR}.{MINOR}.md`. Multi-instance types (ADR, DIAG, WARD, DMC) add a sequence number: `ARC-{PROJECT_ID}-{TYPE}-{NUM}-v{MAJOR}.{MINOR}.md`. IDs are generated by `.arckit/scripts/bash/generate-document-id.sh`.

### Project Structure

- `projects/000-global/` — Cross-project governance artifacts (architecture principles live here as `ARC-000-PRIN-v*.md`)
- `projects/001-smart-meter-app/` — All artifacts for this service, plus `vendors/` for vendor evaluations
- `.arckit/templates/` — 40+ markdown templates used by commands to generate artifacts
- `.arckit/scripts/bash/` — 6 utility scripts (common.sh provides shared functions)
- `.claude/commands/` — 42 slash command definitions (markdown with YAML frontmatter)
- `.codex/prompts/` and `.gemini/commands/` — Same commands for Codex CLI and Gemini CLI
- `docs/guides/` — 50+ user guides for each command

### Dependency Model

Commands have mandatory (M), recommended (R), and optional (O) dependencies on each other's outputs. The full dependency structure matrix is in `DEPENDENCY-MATRIX.md`. Key facts:

- **`ARC-*-REQ-*.md` (requirements) is the central artifact** — consumed by 36 of 42 commands
- **`ARC-000-PRIN-v*.md` (principles) is the governance foundation** — consumed by 20 commands
- **`ARC-*-STKE-*.md` (stakeholders) is third most consumed** — consumed by 20 commands
- Commands are organized into 12 tiers from foundation (Tier 0: plan, principles) through to publishing (Tier 12: pages)

### MCP Server Integration

Two MCP servers are configured in `.mcp.json`:
- **Microsoft Learn MCP** — Used by `/arckit.azure-research` for authoritative Azure documentation
- **AWS Knowledge MCP** — Used by `/arckit.aws-research` for authoritative AWS documentation

## Domain Context

### Service Scope

The app authenticates consumers, retrieves half-hourly gas/electricity data from SMETS1 and SMETS2 smart meters (via DCC and energy supplier APIs), visualises usage, provides energy-saving recommendations, enables tariff comparison, and sends consumption/budget alerts.

### Key Stakeholders

DESNZ (policy owner), Ofgem (regulator), DCC (infrastructure), Energy Suppliers (data providers), Citizens (end users), Smart Energy GB (engagement), GDS/CDDO (standards), ICO (data protection).

### Regulatory Requirements

Smart Energy Code (SEC), Ofgem Supplier Licence Conditions, UK GDPR / DPA 2018, PECR, GDS Service Standard (14 points), Technology Code of Practice (13 points), NCSC Secure by Design, HM Treasury Green/Orange Books, Accessibility Regulations 2018, WCAG 2.2 AA.

### Technical Context

- **Data Sources**: DCC infrastructure, Octopus Energy API, n3rgy Consumer Access API
- **Platform**: Cross-platform mobile (iOS and Android)
- **Hosting**: AWS UK or Azure UK regions
- **Security Classification**: OFFICIAL
- **Users**: ~34 million smart meter households
